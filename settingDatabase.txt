//change _id

db.employees.find().forEach(function(doc){
    old_id = doc._id 
    doc._id=doc.employeeNumber
    db.employees.insert(doc)
    db.employees.remove({_id: old_id})
});

db.offices.find().forEach(function(doc){
    old_id = doc._id 
    doc._id=doc.officeCode
    db.offices.insert(doc)
    db.offices.remove({_id: old_id})
});

db.customers.find().forEach(function(doc){
    old_id = doc._id 
    doc._id=doc.customerNumber
    db.customers.insert(doc)
    db.customers.remove({_id: old_id})
});

db.orderdetails.find().forEach(function(doc){
    old_id = doc._id 
    doc._id=doc.orderLineNumber
    db.orderdetails.insert(doc)
    db.orderdetails.remove({_id: old_id})
});

db.orders.find().forEach(function(doc){
    old_id = doc._id 
    doc._id=doc.orderNumber
    db.orders.insert(doc)
    db.orders.remove({_id: old_id})
});

db.payments.find().forEach(function(doc){
    old_id = doc._id 
    doc._id=doc.checkNumber
    db.payments.insert(doc)
    db.payments.remove({_id: old_id})
});

db.productlines.find().forEach(function(doc){
    old_id = doc._id 
    doc._id=doc.productLine
    db.productlines.insert(doc)
    db.productlines.remove({_id: old_id})
});

db.products.find().forEach(function(doc){
    old_id = doc._id 
    doc._id=doc.productCode
    db.products.insert(doc)
    db.products.remove({_id: old_id})
});

//end change _id

find with foreign key

var dbRef = db.test.findOne({"name":"game"}).employees
db[dbRef.$ref].findOne({"_id":(dbRef.$id)})



findAndUpdateOffice in employees

db.employees.find().forEach(function(emp){
    temp = emp.officeCode
    data = {
         offices : {
            $ref : "offices",
            $id : temp
        }       
    }

    db.employees.update({officeCode:temp},{$set: {officeCode: 
            data
        }
     })
})






db.test.aggregate(
  {$unwind: "$employees"},
  {$lookup: {
    from:"employees",
    localField: "employees",
    foreignField: "_id",
    as: "bar"

   }},
   {$match: {

   }}
)



    data = {
        offices : {
            $ref : offices
            $id : temp
        }
    }
